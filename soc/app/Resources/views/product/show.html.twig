{% extends 'SocBundle::layout.html.twig' %}

{% block body %}
    <h1><span class="label label-success">Product</span></h1>
    <div class="jumbotron">
    <table>
        <tbody class="table table-hover">
            <tr  scope="row">
                <th>Id: </th>
                <td>{{ product.id }}</td>
            </tr>
            <tr>
                <th scope="row">Title: </th>
                <td>{{ product.title }}</td>
            </tr>
            <tr>
                <th scope="row">Description: </th>
                <td>{{ product.description }}</td>
            </tr>
            <tr>
                <th scope="row">Price</th>
                <td>{{ product.price }}</td>
            </tr>
            <tr>
                <th scope="row">Category</th>
                <td><a href="{{ path('category_show', { 'id': product.category.id }) }}">{{ product.category.title }}</a></td>
            </tr>
        </tbody>
    </table>
    </div>
    <table>
        <tbody>
          {% for rating in product.rated %}
            <tr>
                <th>Rater: </th>
                <td>{{ rating.rater.username }}</td>
            </tr>
            <tr>
                <th>Note: </th>
                <td>{% for i in 1..rating.rate %}
                  <span class="glyphicon glyphicon-star"></span>
                {% endfor %}
                {% if rating.rate < 5 %}
                  {% for i in 1..(5 - rating.rate) %}
                    <span class="glyphicon glyphicon-star-empty"></span>
                  {% endfor %}</td></td>
                {% endif %}
            </tr>
            <tr>
                <th>Comment: </th>
                <td>{{ rating.comment }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <p class="col-sm-10">
      {% if app.user != product.user %}
      <tr>
        <td><a href="{{ path('rating_new',{ 'id': product.id, 'type': 'product' })  }}"><button type="button" class="btn btn-default alert alert-info btn-lg">Rate this product</button></a></td>
      </tr>
      {% endif %}
      <a href="{{ path('product_index') }}"><button type="button" class="btn btn-default alert alert-info btn-lg">Back to the list</button></a>
      {% if app.user == product.user or is_granted('ROLE_ADMIN') %}
        <a href="{{ path('product_edit', { 'id': product.id }) }}"><button type="button" class="btn btn-default alert alert-warning btn-lg">Edit</button></a>
      {{ form_start(delete_form) }}
          <input type="submit" value="Delete" class="btn btn-default alert alert-danger btn-lg pull left">
      {{ form_end(delete_form) }}
    {% endif %}
    </p>

{% endblock %}
